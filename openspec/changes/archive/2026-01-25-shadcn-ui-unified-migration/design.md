# 统一迁移 shadcn/ui 组件库和配置 - 设计文档

## 架构概述
本迁移方案旨在将当前项目的组件库体系完全替换为与源项目 PCode.Client 相同的 shadcn/ui 组件库，实现技术栈的统一。

## 核心设计决策

### 1. 组件库统一策略
**决策**：完全复制源项目的 shadcn/ui 组件库

**原因**：
- 确保组件行为和样式的一致性
- 避免重复开发和维护
- 遵循 shadcn/ui 的最佳实践
- 源项目已经过验证，稳定性较高

**组件清单**（共 40+ 个）：
- 基础组件：Button、Input、Card、Badge 等
- 表单组件：Checkbox、Select、Radio Group、Textarea 等
- 对话框组件：Alert Dialog、Dialog、Drawer 等
- 导航组件：Tabs、Pagination、Breadcrumb 等
- 高级组件：Combobox、Dropdown Menu、Menubar 等

### 2. 配置体系统一策略
**决策**：完全采用源项目的配置文件

**变更点**：
- `components.json`：将 style 从 `radix-vega` 更改为 `radix-nova`
- `tailwind.config.js`：添加中文字体支持和游戏化风格变量
- `src/index.css`：更新颜色系统、字体和主题配置

**配置详情**：
- **样式风格**：从 "radix-vega" 更改为 "radix-nova"（源项目风格）
- **字体**：从 Inter 更改为 Noto Sans（中文字体）+ JetBrains Mono（代码字体）
- **颜色系统**：采用源项目的 oklch 颜色空间配置
- **主题**：支持暗色模式和自定义属性主题

### 3. 依赖管理策略
**决策**：基于源项目依赖进行更新

**核心依赖**：
- `@radix-ui/react-*`：Radix UI 基础组件库
- `class-variance-authority`：样式变体管理
- `clsx` 和 `tailwind-merge`：样式合并工具
- `lucide-react`：图标库
- `shadcn`：shadcn/ui 命令行工具

### 4. 项目结构优化
**决策**：保持与源项目一致的目录结构

**目录布局**：
```
src/
├── components/
│   ├── ui/              # shadcn/ui 组件库
│   └── [其他组件]
├── lib/                 # 工具函数
│   └── utils.ts
├── hooks/               # 自定义钩子（待添加）
└── index.css            # 全局样式
```

## 迁移风险评估与缓解

### 风险 1：依赖版本不兼容
**风险**：源项目使用的依赖版本与当前项目可能存在冲突

**缓解**：
- 基于源项目的 package.json 逐步更新依赖
- 使用 npm ls 检查依赖树
- 必要时使用 npm dedupe 解决重复依赖问题

### 风险 2：样式冲突
**风险**：不同的 Tailwind 配置和全局样式可能导致布局问题

**缓解**：
- 完全替换现有配置，避免混合配置
- 使用 Tailwind 的 `@layer` 特性隔离样式
- 测试阶段重点检查布局和样式一致性

### 风险 3：组件 API 不兼容
**风险**：现有代码可能使用了与新组件不同的 API

**缓解**：
- 创建组件使用文档和示例
- 提供迁移指南
- 在测试阶段重点检查组件使用方式

## 验证策略

### 构建验证
- 确保 `npm run build` 成功执行
- 检查是否有 TypeScript 类型错误
- 验证输出 bundle 的完整性

### 功能验证
- 测试现有页面和组件的功能
- 验证表单提交、导航等交互
- 检查响应式布局是否正常

### 性能验证
- 检查页面加载时间
- 验证组件渲染性能
- 确保没有明显的内存泄漏

## 后续优化建议

### 1. 组件文档完善
- 为每个组件添加使用示例
- 创建组件 API 文档
- 添加组件使用最佳实践

### 2. 组件测试
- 为核心组件添加单元测试
- 创建组件快照测试
- 添加集成测试

### 3. 工具链优化
- 配置 shadcn/ui 组件自动导入
- 设置组件使用规范检查
- 优化开发体验

## 总结
本迁移方案通过完全复制源项目的 shadcn/ui 组件库和配置体系，实现了项目间的技术栈统一，提高了组件一致性和可维护性。虽然迁移过程中可能会遇到一些兼容性问题，但通过合理的风险评估和缓解策略，这些问题可以被有效地解决。
